<view class="page-container">
  <!-- è¡¨å¤´å›ºå®šåœ¨é¡¶éƒ¨ -->
  <view class="item-card-header table-header">
    <view class="cell delete-cell-header"></view>
    <view class="cell sortable name-cell-header" bindtap="sortItems" data-field="name">
      å•†å“å
      <text class="sort-icon" wx:if="{{sortField === 'name'}}">
        {{sortOrder === 'asc' ? 'â†‘' : 'â†“'}}
      </text>
    </view>
    <view class="cell sortable price-cell-header" bindtap="sortItems" data-field="price">
      æ€»ä»·
      <text class="sort-icon" wx:if="{{sortField === 'price'}}">
        {{sortOrder === 'asc' ? 'â†‘' : 'â†“'}}
      </text>
    </view>
    <view class="cell sortable spec-cell-header" bindtap="sortItems" data-field="spec">
      è§„æ ¼
      <text class="sort-icon" wx:if="{{sortField === 'spec'}}">
        {{sortOrder === 'asc' ? 'â†‘' : 'â†“'}}
      </text>
    </view>
    <view class="cell sortable quantity-cell-header" bindtap="sortItems" data-field="quantity">
      æ•°é‡
      <text class="sort-icon" wx:if="{{sortField === 'quantity'}}">
        {{sortOrder === 'asc' ? 'â†‘' : 'â†“'}}
      </text>
    </view>
    <view class="cell sortable unitprice-cell-header" bindtap="sortItems" data-field="unitPrice">
      å•ä»·
      <text class="sort-icon" wx:if="{{sortField === 'unitPrice'}}">
        {{sortOrder === 'asc' ? 'â†‘' : 'â†“'}}
      </text>
    </view>
  </view>
  <!-- å†…å®¹å¯æ»šåŠ¨ -->
  <scroll-view class="table-container" scroll-y>
    <view class="table">
      <block wx:for="{{items}}" wx:key="index">
        <view class="item-card {{item.error ? 'error' : ''}} {{item.isLowest ? 'lowest' : ''}} {{item.isHighest ? 'highest' : ''}}">
       <view class="item-row">
          <view class="cell delete-cell">
            <image class="delete-btn" src="/images/trashbin.png" mode="aspectFit" bindtap="deleteItem" data-index="{{index}}" />
          </view>
          <view class="cell name-cell">
            <input class="input {{!item.nameModified ? 'placeholder-text' : ''}}" 
                   value="{{item.name}}" 
                   data-index="{{index}}" 
                   data-field="name" 
                   bindinput="updateItem" />
          </view>
          <view class="cell price-cell">
            <input class="input {{!item.priceModified ? 'placeholder-text' : ''}}" 
                   type="digit" 
                   value="{{item.price}}" 
                   data-index="{{index}}" 
                   data-field="price" 
                   bindinput="updateItem" />
            <icon wx:if="{{item.price && isNaN(item.price)}}" type="warn" size="20" color="red" />
          </view>
          <view class="cell spec-cell">
            <input class="input {{!item.specModified ? 'placeholder-text' : ''}}" 
                   type="digit" 
                   value="{{item.spec}}" 
                   data-index="{{index}}" 
                   data-field="spec" 
                   bindinput="updateItem" />
            <icon wx:if="{{item.spec && isNaN(item.spec)}}" type="warn" size="20" color="red" />
          </view>
          <view class="cell quantity-cell">
            <input class="input {{!item.quantityModified ? 'placeholder-text' : ''}}" 
                   type="number" 
                   value="{{item.quantity}}" 
                   data-index="{{index}}" 
                   data-field="quantity" 
                   bindinput="updateItem" />
          </view>
          <view class="cell unitprice-cell">{{item.unitPrice}}</view>
        </view>
        <view class="tag-row">
          <view wx:if="{{item.isLowest}}" class="tag tag-abs lowest-tag">ğŸŒŸå•ä»·æœ€ä¼˜</view>
          <view wx:if="{{item.isHighest}}" class="tag tag-abs highest-tag">â—æœ€é«˜å•ä»·</view>
        </view>
        </view>
      </block>
    </view>
  </scroll-view>

  <!-- å›ºå®šåœ¨åº•éƒ¨çš„æŒ‰é’®åŒºåŸŸ -->
  <view class="bottom-buttons">
    <view class="action-buttons">
      <button bindtap="addItem">æ·»åŠ å•†å“</button>
      <button bindtap="clearItems">æ¸…ç©º</button>
    </view>
    <view class="save-button">
      <button bindtap="saveRecord">ä¿å­˜æ¯”ä»·è®°å½•</button>
    </view>
  </view>
</view>
